{"version":3,"sources":["main.js"],"names":["Router","routes","this","init","Route","name","htmlName","prototype","arr","window","addEventListener","selectPath","bind","options","location","hash","forEach","element","isActiveRoute","renderView","fetch","then","response","text","res","document","getElementById","innerHTML","config","createPage","panelOfUsers","initPanelOfUsersElements","createUserList","setInterval","updateUserList","hashedPath","substr","elementsId","chatSetup","createChatScript","value","checked","Config","e","userList","sorterTag","filterTag","selectUserId","addUser","userBody","userId","userElement","createElement","userNameElement","userStatusElement","chatStateElement","classList","add","userName","isChatHidden","isRead","Date","lastMessageDate","appendChild","sorter","sortByUserName","sortByOnline","sortByChatState","operatorsChat","openChat","PanelOfUsers","closeButton","removeChildren","filter","filterUsers","childNodes","hidden","sendRequestToDatabase","body","Object","keys","key","addHistoryToPage","OperatorsChat","textArea","message","Message","showMessage","time","sender","Sorter","i","lastElement","newUserElementName","getElementsByClassName","length","insertBefore","newUserElementStatus","newUserElementChatState","Filter","usersArray","filterValue","toLowerCase","userContainer","lastIndexOf","method","path","headers","Accept","Content-Type","JSON","stringify","json","catch","error","console","log","list","lastChild","removeChild","toLocaleString","year","month","day","hour","minute"],"mappings":"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","file":"main.js","sourcesContent":["/* global config */\r\n/* global panelOfUsers */\r\n\r\n(function routing() {\r\n\r\n    function Router(routes) {\r\n        this.routes = routes;\r\n        this.init();\r\n    }\r\n    \r\n    Router.prototype = {\r\n        init: function init() {\r\n            var arr = this.routes;\r\n            \r\n            window.addEventListener('hashchange', function f() {\r\n                this.selectPath(this, arr);\r\n            }.bind(this));\r\n    \r\n            this.selectPath(this, arr);\r\n        },\r\n        selectPath: function selectPath(options, arr){\r\n            if (window.location.hash) {\r\n                arr.forEach(function check(element) {\r\n                    if(element.isActiveRoute(window.location.hash)) {\r\n                        options.renderView(element.htmlName);\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        renderView: function renderView(htmlName) {\r\n                fetch(\r\n                    'https://rawgit.com/NastyaNasalevich/Templates-for-chat/master/' + htmlName\r\n                ).then(function getResponse(response) {\r\n                    return response.text();\r\n                }).then(function getHTML(res) {\r\n                    document.getElementById('main-body').innerHTML = res;\r\n                }).then(function startCode() {\r\n                    if (document.getElementById('config-resultScript')) {\r\n                        config.createPage();\r\n                    }\r\n                    else if (document.getElementById('dashboard-users-list')) {\r\n                        panelOfUsers.initPanelOfUsersElements();\r\n                        panelOfUsers.createUserList();\r\n                        setInterval(panelOfUsers.updateUserList, 5000);\r\n                    }\r\n                });\r\n        }\r\n    \r\n    };\r\n    \r\n    function Route(name, htmlName) {\r\n        this.name = name;\r\n        this.htmlName = htmlName;\r\n    }\r\n    \r\n    Route.prototype.isActiveRoute = function isActiveRoute(hashedPath) {\r\n        return hashedPath.substr(1) === this.name;\r\n    }\r\n    \r\n    new Router([\r\n        new Route('configurator', 'config.html'),            \r\n        new Route('dashboard', 'dashboard.html'),\r\n        new Route('about', 'about.html'),       \r\n    ]);\r\n\r\n})();\r\n\r\n/* exported config */\r\n\r\nvar config = (function config() {\r\n\r\n  var elementsId = [\r\n    'config-title', 'config-botName', 'config-url', 'config-cssClass', 'config-position', 'config-allowMinimize', \r\n    'config-allowDrag', 'config-requireName', 'config-showDate', 'config-xhr', 'config-fetch', 'config-resultScript'\r\n  ];\r\n  \r\n  var chatSetup = {};\r\n  \r\n  function getRequestValue(){\r\n    var requestType;\r\n  \r\n    if(chatSetup['config-xhr'].checked) {\r\n      requestType = \"XHR'\";\r\n    } else {\r\n      requestType = \"fetch'\";\r\n    }\r\n    \r\n    return requestType;\r\n  }\r\n  \r\n  function createChatScript(){\r\n    chatSetup['config-resultScript'].innerHTML = \"&ltscript src='https://rawgit.com/NastyaNasalevich/js--touchsoft/task-02/NastyaNasalevich/my.js?\" +  \r\n    \"'title='\" + chatSetup['config-title'].value  +\r\n    \"'&botName='\" + chatSetup['config-botName'].value + \r\n    \"'&chatUrl='\" + chatSetup['config-url'].value +\r\n    \"'&cssClass='\" + chatSetup['config-cssClass'].value + \r\n    \"'&position='\" + chatSetup['config-position'].value + \r\n    \"'&allowMinimize='\" + chatSetup['config-allowMinimize'].checked + \r\n    \"'&allowDrag='\" + chatSetup['config-allowDrag'].checked + \r\n    \"'&showDateTime='\" + chatSetup['config-showDate'].checked + \r\n    \"'&requireName='\" + chatSetup['config-requireName'].checked + \r\n    \"'&requests='\" + getRequestValue() +\r\n    \"&gt&lt/script&gt\";\r\n   }\r\n  \r\n   function Config() {}\r\n  \r\n   Config.prototype.createPage = function createPage(){\r\n    elementsId.forEach(function changeScript(e) {\r\n      chatSetup[e] = document.getElementById(e);\r\n      chatSetup[e].addEventListener('input', createChatScript)\r\n    });\r\n    createChatScript();\r\n  };\r\n  \r\n  return new Config();\r\n\r\n})();\r\n\r\n/* exported panelOfUsers */\r\n/* global filter */\r\n/* global sorter */\r\n/* global operatorsChat */\r\n/* global removeChildren */\r\n/* global sendRequestToDatabase */\r\n\r\n\r\nvar panelOfUsers = (function createpanelOfUsers() {\r\n    var userList;\r\n    var sorterTag;\r\n    var filterTag;\r\n    var selectUserId;\r\n    \r\n    function addUser(userBody, userId) {\r\n\r\n        var userElement = document.createElement('div');\r\n        var userNameElement = document.createElement('div');\r\n        var userStatusElement = document.createElement('div');\r\n        var chatStateElement = document.createElement('div');\r\n        userNameElement.classList.add('user-name-element');\r\n        userStatusElement.classList.add('user-status-element');\r\n        chatStateElement.classList.add('chat-state-element');\r\n    \r\n        userNameElement.innerHTML = userBody.userName ? userBody.userName : 'Anonymous';\r\n    \r\n        if (userBody.isChatHidden) {\r\n            chatStateElement.innerHTML = ' - ';\r\n        } else {\r\n            chatStateElement.innerHTML = '[ ]';\r\n        }\r\n    \r\n        if (!userBody.isRead) {\r\n            userNameElement.classList.add('unread-state');\r\n        }\r\n        \r\n        if (new Date() - new Date(userBody.lastMessageDate) <= 600000) {\r\n            userStatusElement.innerHTML = 'online';\r\n        }\r\n    \r\n        userElement.appendChild(chatStateElement);\r\n        userElement.appendChild(userStatusElement);\r\n        userElement.appendChild(userNameElement);\r\n        \r\n        if (sorterTag.value === 'User Name') {\r\n            sorter.sortByUserName(userElement, userList);\r\n        } else if (sorterTag.value === 'Online') {\r\n            sorter.sortByOnline(userElement, userList);\r\n        } else if (sorterTag.value === 'Chat state') {\r\n            sorter.sortByChatState(userElement, userList);\r\n        } else  {\r\n            userList.appendChild(userElement);\r\n        }\r\n    \r\n        userElement.addEventListener('click', function readMessages() { \r\n            selectUserId = userId;\r\n            operatorsChat.openChat(userId);\r\n            document.getElementById('active').innerHTML = 'Active:   ' + userNameElement.innerHTML;\r\n            userNameElement.classList.add('read-state');\r\n        });\r\n    }\r\n    \r\n    function PanelOfUsers() {}\r\n\r\n    PanelOfUsers.prototype.initPanelOfUsersElements = function initPanelOfUsersElements() {\r\n        var closeButton = document.getElementById('dashboard-close');\r\n        sorterTag = document.getElementById('dashboard-sorter');\r\n        userList = document.getElementById('dashboard-users-list');\r\n        filterTag = document.getElementById('dashboard-filter');\r\n\r\n        sorterTag.addEventListener('change', function createSortedUserList() {\r\n            removeChildren(userList);\r\n            panelOfUsers.createUserList();\r\n        });\r\n\r\n        filterTag.addEventListener('keyup', function useFilter() {\r\n            filter.filterUsers(document.getElementById('dashboard-filter').value, userList.childNodes);\r\n        }); \r\n\r\n        closeButton.addEventListener('click', function hideOperatorPanel() {\r\n            document.getElementById('dashboard-work-place').hidden = true;\r\n            document.getElementById('dashboard-picture').hidden = false;\r\n        \r\n        });\r\n    }\r\n\r\n    PanelOfUsers.prototype.createUserList = function createUserList() {\r\n        sendRequestToDatabase('GET', 'users/', '').then(function addUsers(body) {\r\n            Object.keys(body).forEach(function appendEachUser(key) {\r\n              addUser(body[key], key);\r\n            });\r\n        });\r\n    }\r\n\r\n    PanelOfUsers.prototype.updateUserList = function updateUserList() {\r\n        sendRequestToDatabase('GET', 'users/', '').then(function updateChanges(body) {\r\n            removeChildren(userList);\r\n            Object.keys(body).forEach(function addChanges(key) {\r\n                addUser(body[key], key);\r\n                if (selectUserId) { \r\n                    operatorsChat.addHistoryToPage(selectUserId);\r\n                }\r\n            });\r\n        })\r\n        .then(function setFilter() {\r\n            filter.filterUsers(document.getElementById('dashboard-filter').value, userList.childNodes);\r\n        });\r\n    }\r\n\r\n    return new PanelOfUsers();\r\n\r\n})();\r\n/* exported operatorsChat */\r\n/* global sendRequestToDatabase */\r\n/* global Message */\r\n\r\nvar operatorsChat = (function createOperatorsChat() {\r\n\r\n    function sendMessage(userId) {\r\n        var textArea = document.getElementById('dashboard-chat-textarea');\r\n        var text = textArea.value;\r\n        var message = new Message(new Date(), 'Operator', text);\r\n        document.getElementById('dashboard-history-panel').innerHTML += '<br>' + message.showMessage();\r\n        sendRequestToDatabase('POST', 'messages/', userId, message);\r\n        textArea.value = '';\r\n     }\r\n\r\n    function OperatorsChat() {}\r\n    \r\n    OperatorsChat.prototype.openChat = function openChat(userId) {\r\n        document.getElementById('dashboard-work-place').hidden = false;\r\n        document.getElementById('dashboard-picture').hidden = true;\r\n        sendRequestToDatabase('PUT', 'users/' + userId, '/isRead', true);\r\n        operatorsChat.addHistoryToPage(userId);\r\n    \r\n        document.getElementById('dashboard-chat-textarea').addEventListener('click', function f() {\r\n            sendRequestToDatabase('PUT', 'users/' + userId, '/isRead', true);\r\n        });\r\n    \r\n        document.getElementById('dashboard-chat-button').addEventListener('click', function f() {\r\n            sendMessage(userId);\r\n        });\r\n    }\r\n    \r\n     OperatorsChat.prototype.addHistoryToPage = function addHistoryToPage(userId) {\r\n        sendRequestToDatabase('GET', 'messages/', userId).then(\r\n            function displayMessages(body) {\r\n                var message;\r\n                document.getElementById('dashboard-history-panel').innerHTML = '';\r\n                if (body) {\r\n                    Object.keys(body).forEach(function addEachMessage(key) {\r\n                        message = new Message(new Date(body[key].time), body[key].sender, body[key].body);\r\n                        document.getElementById('dashboard-history-panel').innerHTML += '<br>' + message.showMessage();\r\n                    });\r\n                }\r\n            }\r\n        );    \r\n    }\r\n\r\n    return new OperatorsChat();\r\n\r\n})();\r\n/* exported sorter */\r\n\r\nvar sorter = (function createSorter() {\r\n\r\n    function Sorter() {}\r\n\r\n    Sorter.prototype.sortByUserName = function sortByUserName(userElement, userList) {\r\n        var lastElement = true;\r\n        var newUserElementName = userElement.getElementsByClassName('user-name-element')[0].innerHTML;\r\n        var i;\r\n    \r\n        for (i = 0; i < userList.childNodes.length; i++) {\r\n            if (newUserElementName <= userList.childNodes[i].getElementsByClassName('user-name-element')[0].innerHTML) {\r\n                userList.insertBefore(userElement, userList.childNodes[i]);\r\n                lastElement = false;\r\n                break;\r\n            }\r\n        }\r\n    \r\n       if(lastElement) {\r\n            userList.appendChild(userElement);\r\n       }\r\n    }\r\n    \r\n    Sorter.prototype.sortByOnline = function sortByOnline(userElement, userList) {\r\n        var lastElement = true;\r\n        var newUserElementStatus = userElement.getElementsByClassName('user-status-element')[0].innerHTML;\r\n        var i;\r\n    \r\n        for (i = 0; i < userList.childNodes.length; i++) {\r\n            if (newUserElementStatus === 'online') {\r\n                userList.insertBefore(userElement, userList.childNodes[i]);\r\n                lastElement = false;\r\n                break;\r\n            }\r\n        }\r\n    \r\n        if (lastElement) {\r\n            userList.appendChild(userElement);\r\n        }\r\n    }\r\n    \r\n    Sorter.prototype.sortByChatState = function sortByChatState(userElement, userList) {\r\n        var lastElement = true;\r\n        var newUserElementChatState = userElement.getElementsByClassName('chat-state-element')[0].innerHTML;\r\n        var i;\r\n    \r\n        for(i = 0; i < userList.childNodes.length; i++) {\r\n            if(newUserElementChatState === '[ ]') {\r\n                userList.insertBefore(userElement, userList.childNodes[i]);\r\n                lastElement = false;\r\n                break;\r\n            }\r\n        }\r\n    \r\n        if(lastElement) {\r\n            userList.appendChild(userElement);\r\n        }\r\n    }\r\n\r\n    return new Sorter();\r\n\r\n})();\r\n/* exported filter */\r\n\r\nvar filter = (function createFilter() {\r\n\r\n    function Filter() {}\r\n\r\n    Filter.prototype.filterUsers = function filterUsers(value, usersArray) {\r\n        var filterValue = value.toLowerCase();\r\n    \r\n        if (filterValue === '') {\r\n            return;\r\n        }\r\n    \r\n        usersArray.forEach(function hideAllUsers(userContainer) {\r\n            userContainer.hidden = false;\r\n        });\r\n    \r\n        usersArray.forEach(function hideExcessUsers(userContainer) {\r\n          if (userContainer.getElementsByClassName('user-name-element')[0]\r\n              .innerHTML.toLowerCase()\r\n              .lastIndexOf(filterValue) === -1\r\n          ) {\r\n            userContainer.hidden = true;\r\n          }\r\n        });\r\n    }\r\n\r\n    return new Filter();\r\n\r\n})();\r\n\r\n/* exported sendRequestToDatabase */\r\n\r\nfunction sendRequestToDatabase(method, path, key, body) {\r\n    var chatURL = 'https://mychat-b0091.firebaseio.com/';\r\n    return fetch(\r\n        chatURL + path + key + '.json',\r\n        {\r\n            headers: {\r\n                Accept: 'application/json',\r\n                'Content-Type': 'application/json'\r\n            },\r\n            method: method,\r\n            body: JSON.stringify(body)\r\n        }\r\n    )  \r\n    .then(function getResponse(response) {\r\n        return response.json();\r\n    }).catch(function err(error) {\r\n        console.log('There has been a problem with your fetch operation: ', error.message);\r\n    });\r\n}\r\n/* exported Message */\r\n\r\nfunction Message(time, sender, body) {\r\n    this.time = time;\r\n    this.sender = sender;\r\n    this.body = body;\r\n}\r\n\r\n Message.prototype.showMessage = function showMsg() {\r\n    \r\n    var options = {\r\n        year: 'numeric',\r\n        month: 'long',\r\n        day: 'numeric',\r\n        hour: 'numeric',\r\n        minute: 'numeric',\r\n     };\r\n     \r\n    return this.time.toLocaleString('en-US', options) + ' ' + '<br>' + this.sender + ': ' + this.body + '<br>';\r\n}\r\n/* exported removeChildren */\r\n\r\nfunction removeChildren(list) {\r\n\r\n    while (list.lastChild) {\r\n        list.removeChild(list.lastChild);\r\n    }\r\n\r\n}"]}